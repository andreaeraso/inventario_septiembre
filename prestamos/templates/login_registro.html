{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Login y Registro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


    <!-- Iconos -->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

    <!-- Manifest (PWA) -->
    <link rel="manifest" href="{% static 'manifest.json' %}">

    <!-- jQuery (debe ir antes que Bootstrap y AdminLTE) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- AdminLTE -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
    <script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>

    <!-- Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register("{% static 'js/service-worker.js' %}")
                    .then(function(registration) {
                        console.log('ServiceWorker registrado con √©xito:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Error al registrar el ServiceWorker:', error);
                    });
            });
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(90deg, #e2e2e2, #c9ffd6);
        }

.install-banner {
        position: absolute;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid #dcdcdc;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    padding: 10px 16px;
    width: auto;
    margin-top: 700px;
    max-width: 380px;
    font-size: 16px;
    color: #0a7735;
    z-index: 9999;
    transition: all 0.3s 
ease;
}
.registro-header {
    align-items: center;
    justify-content: center;
}

.registro-titulo {
    font-size: 20px;
    font-weight: 700;
    color: #0a7735;
}

.registro-header .ayuda-btn {
    width: 34px;
    height: 34px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.login-box-borde .ayuda-btn {
    position: absolute;
    top: -20px;      /* üîº baja o sube */
    right: 34px;    /* ‚¨ÖÔ∏è mueve a la izquierda */
    width: 34px;
    height: 34px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
}


/* Texto */
.install-text {
    font-weight: 600;
    color: #0a7735;
}

/* Bot√≥n */
#installButton {
    background: #0a7735;
    color: #fff;
    border: none;
    padding: 10px 14px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s ease;
}

/* Hover */
#installButton:hover {
    background: #09642d;
}

/* √çcono */
#installButton i {
    font-size: 18px;
}

        .titulo-login {
            font-size: 15px;
            font-weight: 700;
            color: #0a7735;
            text-align: center;
            margin-bottom: 20px;
            letter-spacing: 0.5px;
        }

        .input-login {
            position: relative;
            width: 100%;
            margin-bottom: 20px;
        }

        .input-login input {
            width: 100%;
            padding: 14px 40px 14px 15px;
            font-size: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #ccc;
            outline: none;
            font-weight: 500;
            height: 48px;
        }

        .input-login i {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #0a7735;
            font-size: 18px;
        }

        .btn-login {
            width: 100%;
            height: 52px;
            background: #0a7735;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, .15);
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #fff;
            font-weight: 600;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .btn-login:hover {
            background: #0d8b40;
            transform: scale(1.03);
        }

        .titulo-sistema {
            font-size: 20px;
            font-weight: 700;
            color: #0a7735;
            text-align: center;
            margin-bottom: 25px; /* deja espacio entre el t√≠tulo y el subt√≠tulo */
            letter-spacing: 0.5px;
        }


        .logo-login {
            display: block;
            margin: 0 auto 15px auto;
            width: 150px;
            height: 150px;
            object-fit: contain;
            }

.register-box-borde .input-box:last-of-type {
    margin-bottom: 10px;
}
.login-box-borde {
    padding: 90px 70px;            /* üîπ Aumenta el tama√±o interno (m√°s grande) */
    margin-top: 50px;              /* üîπ Lo empuja hacia abajo */
    margin-bottom: 100px;          /* Mantiene espacio inferior */
    background-color: #ffffff;
    transform: scale(1.08);        /* üîπ Lo hace ligeramente m√°s grande */
    transition: all 0.3s ease;
    border-radius: 20px;           /* üîπ Le da bordes m√°s suaves */
}

        .register-box-borde {
            border: 2px solid #0a7735;
            border-radius: 12px;
            padding: 25px 20px 30px 20px; /* antes 35px 30px 40px 30px */
            margin-top: 5px;
            margin-bottom: 15px;
            background-color: #ffffff;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            max-width: 420px; /* üîπ controla el ancho total */
            margin-left: auto;
            margin-right: auto;
        }

        /* üîπ Quita la barra gris de desplazamiento en el registro */
        .form-box form {
            scrollbar-width: none;      /* Firefox */
            -ms-overflow-style: none;   /* Internet Explorer / Edge antiguo */
        }

        .form-box form::-webkit-scrollbar {
            display: none;              /* Chrome, Safari y Opera */
        }

        .container {
    position: relative;
    width: 1200px;
    height: 660px;
    background: #fff;
    border-radius: 30px;
    box-shadow: 0 0 30px rgb(0, 0, 0, .2);
    margin: 25px;
    overflow: hidden;
}

        .form-box {
            position: absolute;
            right: 0;
            width: 50%;
            height: 100%;
            background: #fff;
            display: flex;
            align-items: center;
            color: #333;
            text-align: center;
            padding: 24px 29px 28px 26px;
            z-index: 1;
            transition: .6s ease-in-out 1.2s, visibility 0s 1s;
        }

        .container.active .form-box {
            right: 50%;
        }

        form {
            width: 100%;
        }

        .container h1 {
            font-size: 30px;
            margin: -5px 0 10px;
        }

        .input-box {
            position: relative;
            margin: 11px 0;
        }

        .input-box input {
            width: 100%;
            padding: 2px 28px 6px 10px; /* üî∏ Menos alto */
            font-size: 12px;            /* üî∏ Letra m√°s peque√±a */
            background: #f2f2f2;
            border-radius: 5px;
            border: none;
            outline: none;
            font-weight: 500;
            height: 32px;               /* üî∏ Controla altura fija */
        }

        .input-box input::placeholder {
            color: #888;
            font-weight: 400;
        }

        .input-box i {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 22px;
            color: #888;
        }

        .btn {
            width: 100%;
            height: 38px; /* antes 44px */
            background: #0a7735;
            border-radius: 8px;
            box-shadow: 0 0 8px rgb(0, 0, 0, .1);
            border: none;
            cursor: pointer;
            font-size: 14px; /* antes 15px */
            color: #fff;
            font-weight: 600;
        }

        .form-box form {
            max-height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .form-box.register {
            visibility: hidden;
        }

        .container.active .form-box.register {
            visibility: visible;
        }

        .toggle-box {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .toggle-box::before {
            content: '';
            position: absolute;
            left: -250%;
            width: 300%;
            height: 100%;
            background: #0a7735;
            border-radius: 150px;
            z-index: 2;
            transition: 1.8s ease-in-out;
        }

        .container.active .toggle-box::before {
            left: 50%;
        }

        .toggle-panel {
            position: absolute;
            width: 50%;
            height: 100%;
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2;
            transition: .6s ease-in-out;
        }

        .toggle-panel p {
            margin-bottom: 0px;
            padding: 20px;
        }

        .toggle-panel .btn {
            width: 180px;
            height: 50px;
            font-size: 16px;
            background: transparent;
            border: 2px solid #fff;
            box-shadow: none;
        }

        .toggle-panel h1 {
            font-size: 36px;
        }

        .toggle-panel.toggle-right {
            right: -50%;
            transition-delay: .6s;
        }

        .container.active .toggle-panel.toggle-right {
            right: 0;
            transition-delay: 1.2s;
        }

        .toggle-panel.toggle-left {
            left: 0;
            transition-delay: 1.2s;
        }

        .container.active .toggle-panel.toggle-left {
            left: -50%;
            transition-delay: .6s;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }

        .form-row .col {
            flex: 1;
            min-width: 0;
        }

        .input-box {
            position: relative;
            margin: 15px 0 10px;
            /* deja espacio para el mensaje */
        }

        .input-box p {
            position: absolute;
            bottom: -18px;
            /* mensaje fijo debajo del input */
            left: 5px;
            margin: 0;
            font-size: 13px;
            text-align: left;
            line-height: 1;
        }

        .toggle-panel.toggle-left h1 {
            margin-bottom: 1px;
            /* antes era m√°s grande, ahora es compacto */
        }

        .toggle-panel.toggle-left p {
            margin-top: 0;
            /* elimina espacio adicional arriba del p√°rrafo */
        }

        .toggle-panel.toggle-right h1 {
            margin-bottom: 1px;
            /* antes era m√°s grande, ahora es compacto */
        }

        .toggle-panel.toggle-right p {
            margin-top: 0;
            /* elimina espacio adicional arriba del p√°rrafo */
        }

        .escudo-register {
            width: 180px;
            height: auto;
            margin-bottom: 35px;
            filter: brightness(0) invert(1);
            opacity: 0.9;
        }

        .escudo-universidad {
            width: 180px;
            height: auto;
            margin-bottom: 35px;
            filter: brightness(0) invert(1);
            opacity: 0.9;
        }

        .footer-principal {
            position: fixed;             /* siempre visible al fondo */
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #0a7735;   /* verde institucional */
            color: #e9ffe6;              /* texto claro */
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 40px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .footer-left {
            font-weight: 500;
        }

        .footer-right {
            font-weight: 500;
        }


        .subtitulo-sistema {
            font-size: 15px;         /* tama√±o de fuente del subt√≠tulo */
            color: #555;             /* color gris neutro */
            margin-top: -5px;        /* ajusta el espacio con el t√≠tulo */
            margin-bottom: 25px;     /* deja aire antes del primer input */
            font-weight: 400;
            line-height: 1.4;
        }

                .subtitulo-sistema {
            font-size: 15px;         /* tama√±o de fuente del subt√≠tulo */
            color: #555;             /* color gris neutro */
            margin-top: -5px;        /* ajusta el espacio con el t√≠tulo */
            margin-bottom: 25px;     /* deja aire antes del primer input */
            font-weight: 400;
            line-height: 1.4;
        }


         .subtitulo-sistema {
            font-size: 15px;         /* tama√±o de fuente del subt√≠tulo */
            color: #555;             /* color gris neutro */
            margin-top: -5px;        /* ajusta el espacio con el t√≠tulo */
            margin-bottom: 25px;     /* deja aire antes del primer input */
            font-weight: 400;
            line-height: 1.4;
        }


       

 @media screen and (max-width: 650px) {


            .register-box-borde {
    border: 2px solid #0a7735;
    border-radius: 12px;
    padding: 2px 10px 18px 10px;
    margin-top: 20px;
    margin-bottom: 2px;
    background-color: #ffffff;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    max-width: 420px;
    margin-left: auto;
    margin-right: auto;
}

.login-box-borde .ayuda-btn {
    position: absolute;
    top: 7px;      /* üîº baja o sube */
    right: 8px;    /* ‚¨ÖÔ∏è mueve a la izquierda */
    width: 20px;
    height: 20px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
}
.register-box-borde .input-box:last-of-type {
    margin-bottom: 10px;
}
.registro-header {
    margin-top: 5px;
    margin-bottom: 3px;
    padding-top: 3px;
}

.registro-titulo {
    font-size: 14px;
    font-weight: 700;
    color: #0a7735;
}

.registro-header .ayuda-btn {
    width: 25px;
    height: 25px;
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
}

            .container {
                height: calc(100vh - 100px);
            }

               .form-box {
        bottom: 0;
        width: 100%;
        height: 75%;
    }

            .container.active .form-box {
                right: 0;
                bottom: 30%;
            }

            .toggle-box::before {
                left: 0;
                top: -270%;
                width: 100%;
                height: 300%;
                border-radius: 20vw;
            }

            .container.active .toggle-box::before {
                top: 70%;
                left: 0;
            }

            .toggle-panel {
                width: 100%;
                height: 30%;
            }

            .toggle-panel.toggle-left {
                top: 0;
            }

            .container.active .toggle-panel.toggle-left {
                left: 0;
                top: -30%;
            }

            .toggle-panel.toggle-right {
                right: 0;
                bottom: -30%;
            }

            .container.active .toggle-panel.toggle-right {
                bottom: 0;
            }

                .input-box input {
        padding: 14px 45px 14px 10px;
        font-size: 10px;
        height: 38px;
    }

            .container h1 {
                font-size: 30px;
            }

            .escudo-universidad {
        width: 85px;
        height: auto;
        margin-bottom: 15px;
        filter: brightness(0) invert(1);
        opacity: 0.9;
        margin-top: 20px;
    }

                .toggle-panel p {
        margin-bottom: 0px;
        padding: 8px;
        font-size: 13px;
    }
         .container h1 {
        font-size: 24px;
        margin-top: 3px;
    }



        .register-h1 {
        font-size: 20px;
    }
     
    .toggle-panel .btn {
    width: 100px;
    height: 35px;
    font-size: 12px;
    background: transparent;
    border: 2px solid #fff;
    box-shadow: none;
}

.login-box-borde {
    padding: 5px 10px;
    margin-top: 0;
    margin-bottom: 100px;
    background-color: #ffffff;
    transform: scale(1.05);
    transition: all 0.3s ease;
}
    .toggle-panel {
        width: 100%;
        height: 27%;
    }


    .install-banner {
        position: relative;
        bottom: auto;
        left: auto;
        transform: none;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid #dcdcdc;
        border-radius: 10px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        padding: 8px 14px;
        margin-top: 10px;
        width: 100%;
        margin-top: -65px;
        font-size: 15px;
        color: #0a7735;
        transition: all 0.3s 
ease;
    }


/* Texto */
.install-text {
    font-weight: 600;
    color: #0a7735;
}

/* Bot√≥n */
#installButton {
    background: #0a7735;
    color: #fff;
    border: none;
    padding: 10px 14px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s ease;
}

/* Hover */
#installButton:hover {
    background: #09642d;
}

/* √çcono */
#installButton i {
    font-size: 18px;
}

.toggle-box {
    position: absolute;
    top: 0;
    left: 0;         /* üëà esto asegura que empiece pegado al borde izquierdo */
    width: 100%;
    height: 100%;
}


.input-login input {
    width: 100%;
    padding: 14px 40px 14px 15px;
    font-size: 15px;
    background: #f9f9f9;
    border-radius: 8px;
    border: 1px solid #ccc;
    outline: none;
    font-weight: 200;
    height: 35px;
}

.btn login-btn {
    width: 100%;
    height: 35px;
    background: #0a7735;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, .15);
    border: none;
    cursor: pointer;
    font-size: 14px;
    color: #fff;
    font-weight: 600;
    transition: background 0.3s 
ease, transform 0.2s 
ease;
}

.footer-principal {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #0a7735;
    color: #e9ffe6;
    font-size: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 9px 9px;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}


#installButton:hover {
    background: #09933e;
    transform: scale(1.05);
    transition: all 0.2s ease;
}

.titulo-login {
    font-size: 14px;
    font-weight: 700;
    color: #0a7735;
    text-align: center;
    margin-top: 30px;   
    margin-bottom: 30px;
    letter-spacing: 0.5px;
}


.escudo-register {
    width: 80px;
        height: auto;
        margin-bottom: 0px;
        filter: brightness(0) invert(1);
        opacity: 0.9;
        margin-top: 0px;
}

.btn register-btn {
 width: 100%;
    height: 30px;
    background: #0a7735;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, .15);
    border: none;
    cursor: pointer;
    font-size: 14px;
    color: #fff;
    font-weight: 600;
    transition: background 0.3s 
ease, transform 0.2s 
ease;
}  }
    </style>
    
</head>

<footer class="footer-principal">
    <div class="footer-left">
        <strong>Copyright ¬© 2025</strong> Todos los derechos reservados.
    </div>
    <div class="footer-right">
        Versi√≥n <strong>1.0.0</strong>
    </div>
</footer>

<body>
    <div class="container">

        <!-- LOGIN -->
        <div class="form-box login">
    <form method="POST">
        {% csrf_token %}
        <input type="hidden" name="form_type" value="login">
      

<div class="login-box-borde position-relative">

    <!-- HEADER LOGIN -->
    <div class="d-flex align-items-center justify-content-between mb-3">

                <!-- BOT√ìN AYUDA LOGIN -->
        <button type="button"
            class="btn btn-outline-success btn-sm rounded-circle ayuda-btn"
            data-video="kzUVJOzYboU"
            title="¬øC√≥mo iniciar sesi√≥n?">
            <i class="fas fa-question"></i>
        </button>
    </div>


        <p class="titulo-login ">
            Sistema de Pr√©stamo de Equipos Acad√©micos de la Universidad de Nari√±o
        </p>

    <div class="input-login">
        <input type="text" name="codigo" placeholder="C√≥digo" required>
        <i class='bx bx-user'></i>
    </div>

    <div class="input-login">
        <input type="password" name="password" placeholder="Contrase√±a" required>
        <i class='bx bx-lock-alt'></i>
    </div>

    <button type="submit" class="btn-login">Ingresar</button>



            <!-- Mensajes SOLO para login -->
            {% if messages %}
            {% for message in messages %}
            {% if 'error_login' in message.tags %}
            <p class="text-danger flash-msg" style="font-size:14px; margin-top:10px;">{{ message }}</p>
            {% elif 'success_login' in message.tags %}
            <p class="text-success flash-msg" style="font-size:14px; margin-top:10px;">{{ message }}</p>
            {% endif %}
            {% endfor %}
            {% endif %}
        </div>

        <!-- üî∞ BOT√ìN DE DESCARGA DE LA APLICACI√ìN -->
<div class="install-banner">
  <span class="install-text">Descarga la App</span>
  <button id="installButton">
    <i class="fa-solid fa-download"></i>
  </button>
</div>
    </form>

</div>


<!-- REGISTRO -->
<div class="form-box register">
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="form_type" value="registro">

        <!-- CUADRO VERDE -->
        <div class="register-box-borde position-relative">

            <!-- HEADER REGISTRO -->
<div class="registro-header d-flex align-items-center justify-content-between ">
    <h4 class="registro-titulo ">
       Formulario de Registro
    </h4>

    <button type="button"
        class="btn btn-outline-success btn-sm rounded-circle ayuda-btn"
        data-video="dQw4w9WgXcQ"
        title="¬øC√≥mo registrarse?">
        <i class="fas fa-question"></i>
    </button>
</div>


            <!-- Nombre y Apellido en fila -->
            <div class="form-row">
                <div class="col input-box">
                    <input type="text" name="first_name" placeholder="Nombres" required>
                    <i class='bx bx-user'></i>
                </div>
                <div class="col input-box">
                    <input type="text" name="last_name" placeholder="Apellidos" required>
                    <i class='bx bx-user'></i>
                </div>
            </div>

            <!-- Email -->
            <div class="input-box">
                <input type="email" name="email" id="email" placeholder="Email" required>
                <i class='bx bx-envelope'></i>
                <p id="email-msg" style="font-size:13px; margin-top:3px; text-align:left;"></p>
            </div>

            <!-- C√≥digo y Programa en fila -->
            <div class="form-row">
                <div class="col input-box">
                    <input type="text" name="codigo" id="codigo" placeholder="C√≥digo" required>
                    <i class='bx bx-id-card'></i>
                    <p id="codigo-msg" style="font-size:13px; margin-top:3px; text-align:left;"></p>
                </div>
                <div class="col input-box">
                    <input type="text" name="programa" placeholder="Programa" required>
                    <i class='bx bx-book'></i>
                </div>
            </div>

            <!-- Rol -->
            <div class="input-box">
               <select name="rol" required class="custom-select" style="height: 38px; font-size: 13px; padding-left: 10px; border-radius: 6px;">
                    <option value="">Seleccione su rol</option>
                    <option value="estudiante">Estudiante</option>
                    <option value="profesor">Profesor</option>
                </select>
            </div>

            <div class="col input-box">
                <label for="foto"
                    style="display:block; text-align:left; font-size:14px; color:#555; margin-bottom:5px;">
                    Foto de perfil
                </label>
                <input type="file" id="foto" name="foto" accept="image/*" style="padding-left: 20px;">
            </div>

            <!-- Contrase√±as -->
            <div class="form-row">
                <div class="col input-box">
                    <input type="password" name="password1" placeholder="Contrase√±a" required>
                    <i class='bx bx-lock-alt'></i>
                </div>
                <div class="col input-box">
                    <input type="password" name="password2" placeholder="Confirmar contrase√±a" required>
                    <i class='bx bx-lock-alt'></i>
                </div>
            </div>

            <!-- Mensaje din√°mico contrase√±as -->
            <p id="password-match-msg" style="font-size:13px; margin-top:5px; text-align:left;"></p>

            <!-- Mensajes SOLO para registro -->
            {% if messages %}
            {% for message in messages %}
            {% if 'error_register' in message.tags %}
            <p class="text-danger flash-msg" style="font-size:13px; margin-top:5px; text-align:left;">{{ message }}</p>
            {% elif 'success_register' in message.tags %}
            <p class="text-success flash-msg" style="font-size:13px; margin-top:5px; text-align:left;">{{ message }}</p>
            {% endif %}
            {% endfor %}
            {% endif %}



            <button type="submit" class="btn">Registrarse</button>
        </div> <!-- üî∞ cierre del cuadro verde -->

    </form>
</div>


        <!-- Toggle Panel -->
        <div class="toggle-box">
            <div class="toggle-panel toggle-left">
                <img src="/media/encabezado_contratos/escudoblanco.png" alt="Escudo Universidad de Nari√±o"
                    class="escudo-register">
                <h1>Bienvenido</h1>
                <p>¬øNo tienes cuenta?</p>
                <button class="btn register-btn">Reg√≠strate</button>
            </div>
            <div class="toggle-panel toggle-right">
                <img src="/media/encabezado_contratos/escudoblanco.png" alt="Escudo Universidad de Nari√±o" class="escudo-register">
                <h1 class="register-h1 ">Hola de nuevo</h1>
                <p>¬øYa tienes una cuenta?</p>
                <button class="btn login-btn">Ingresar</button>
            </div>
        </div>
    </div>

    <!-- Flip card -->
    <script>
        const container = document.querySelector('.container');
        const registerBtn = document.querySelector('.register-btn');
        const loginBtn = document.querySelector('.login-btn');

        registerBtn.addEventListener('click', () => container.classList.add('active'));
        loginBtn.addEventListener('click', () => container.classList.remove('active'));

        // Ocultar mensajes flash despu√©s de 3s
        setTimeout(() => {
            document.querySelectorAll('.flash-msg').forEach(msg => {
                msg.style.transition = "opacity 0.5s ease";
                msg.style.opacity = "0";
                setTimeout(() => msg.remove(), 500);
            });
        }, 3000);
    </script>

    <!-- Validaci√≥n Email y C√≥digo -->
    <script>
        function validarCampo(inputId, msgId, url) {
            const input = document.getElementById(inputId);
            const msg = document.getElementById(msgId);

            input.addEventListener("blur", function () {
                const valor = input.value.trim();
                if (valor.length > 0) {
                    fetch(`${url}?valor=${encodeURIComponent(valor)}`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.exists) {
                                msg.textContent = "‚ùå " + data.message;
                                msg.style.color = "red";
                            } else {
                                msg.textContent = "‚úÖ Disponible";
                                msg.style.color = "green";
                            }
                        })
                        .catch(error => {
                            console.error("Error en validaci√≥n:", error);
                            msg.textContent = "‚ö† Error al validar";
                            msg.style.color = "orange";
                        });
                } else {
                    msg.textContent = "";
                }
            });
        }

        validarCampo("email", "email-msg", "{% url 'check_email' %}");
        validarCampo("codigo", "codigo-msg", "{% url 'check_codigo' %}");
    </script>

    <!-- Validaci√≥n contrase√±as -->
    <script>
        const pass1 = document.querySelector('input[name="password1"]');
        const pass2 = document.querySelector('input[name="password2"]');
        const msg = document.getElementById('password-match-msg');

        function checkPasswords() {
            if (pass1.value && pass2.value) {
                if (pass1.value === pass2.value) {
                    msg.textContent = "‚úÖ Las contrase√±as coinciden";
                    msg.style.color = "green";
                } else {
                    msg.textContent = "‚ùå Las contrase√±as no coinciden";
                    msg.style.color = "red";
                }
            } else {
                msg.textContent = "";
            }
        }

        pass1.addEventListener('input', checkPasswords);
        pass2.addEventListener('input', checkPasswords);
    </script>

    <!-- AdminLTE Scripts -->
    <script src="{% static 'adminlte/plugins/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'adminlte/js/adminlte.min.js' %}"></script>

    <!-- AdminLTE Scripts -->
    <script src="{% static 'adminlte/plugins/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'adminlte/js/adminlte.min.js' %}"></script>

    <!-- Service Worker  -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/static/js/service-worker.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registrado con √©xito:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Error al registrar el ServiceWorker:', error);
                    });
            });
        }
    </script>
    <script>
  let deferredPrompt;
  const installBanner = document.querySelector('.install-banner');
  const installButton = document.getElementById('installButton');

  // Por defecto, ocultamos el banner
  installBanner.style.display = 'none';

  // Detectar si la app ya est√° instalada (modo PWA)
  if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
      console.log('‚úÖ La app ya est√° instalada');
      installBanner.style.display = 'none'; // Oculta el bot√≥n
  } else {
      console.log('üì± La app NO est√° instalada');
  }

  // Evento que se dispara cuando el navegador permite instalar la PWA
  window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      installBanner.style.display = 'flex'; // Mostrar el banner solo si es instalable
  });

  // Cuando el usuario hace clic en "Descargar"
  installButton.addEventListener('click', async () => {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      if (outcome === 'accepted') {
          console.log('‚úÖ Usuario acept√≥ instalar la app');
      } else {
          console.log('‚ùå Usuario rechaz√≥ la instalaci√≥n');
      }
      deferredPrompt = null;
      installBanner.style.display = 'none';
  });

  // Si el usuario instala la app, ocultamos el banner
  window.addEventListener('appinstalled', () => {
      console.log('üéâ App instalada correctamente');
      installBanner.style.display = 'none';
  });
</script>

    <script>
  let deferredPrompt;

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('installBanner').style.display = 'block';
  });

  document.getElementById('installButton').addEventListener('click', async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      const result = await deferredPrompt.userChoice;
      if (result.outcome === 'accepted') {
        console.log('‚úÖ App instalada');
      }
      document.getElementById('installBanner').style.display = 'none';
    }
  });
</script>


    <!-- SweetAlert2 para mensajes (tuyos) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            {% if messages %}
                {% for message in messages %}
                    {% if 'success_register' in message.tags %}
                        Swal.fire({
                            icon: 'success',
                            title: '¬°Registro exitoso!',
                            text: '{{ message|escapejs }}',
                            confirmButtonColor: '#0a7735',
                            confirmButtonText: 'Ir al inicio de sesi√≥n',
                            background: '#fff',
                            customClass: {
                                popup: 'swal2-rounded',
                                title: 'swal2-title-custom',
                                confirmButton: 'swal2-confirm-custom'
                            }
                        }).then(() => {
                            // üîÅ Al cerrar el popup, va al login
                            const loginBtn = document.querySelector('.login-btn');
                            if (loginBtn) loginBtn.click();
                        });
                    {% elif 'error_register' in message.tags %}
                        Swal.fire({
                            icon: 'error',
                            title: 'Error en el registro',
                            text: '{{ message|escapejs }}',
                            confirmButtonColor: '#d33',
                            confirmButtonText: 'Reintentar',
                            background: '#fff',
                            customClass: {
                                popup: 'swal2-rounded',
                                title: 'swal2-title-custom',
                                confirmButton: 'swal2-confirm-custom'
                            }
                        });
                    {% endif %}
                {% endfor %}
            {% endif %}
        });
    </script>

<!-- Mensaje de errores general -->
    {% if messages %}
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            {% for message in messages %}
                {% if 'error_login' in message.tags %}
                    Swal.fire({
                        icon: 'error',
                        title: 'Error de inicio de sesi√≥n',
                        text: '{{ message|escapejs }}',
                        confirmButtonColor: '#0a7735',
                        confirmButtonText: 'Entendido'
                    });
                {% elif 'success_login' in message.tags %}
                    Swal.fire({
                        icon: 'success',
                        title: 'Bienvenido',
                        text: '{{ message|escapejs }}',
                        confirmButtonColor: '#0a7735',
                        confirmButtonText: 'Continuar'
                    });
                {% endif %}
            {% endfor %}
        });
    </script>

    <script>
    let deferredPrompt;
    const installBanner = document.getElementById('installBanner');
    const installButton = document.getElementById('installButton');

    // Escucha el evento antes de instalar (para m√≥viles y navegadores compatibles)
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installBanner.style.display = 'block';  // Mostrar banner
    });

    // Cuando el usuario hace clic en el bot√≥n "Descargar aplicaci√≥n"
    installButton.addEventListener('click', async () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response: ${outcome}`);
            deferredPrompt = null;
            installBanner.style.display = 'none'; // Ocultar despu√©s de instalar
        } else {
            // Si no hay evento, ofrecer una descarga directa del manifest
            window.location.href = "{% static 'manifest.json' %}";
        }
    });

    // Para escritorio: mostrar el mismo banner simulando instalaci√≥n
    window.addEventListener('load', () => {
        // Si no hay soporte PWA, igualmente mostrar el bot√≥n
        setTimeout(() => {
            if (!window.matchMedia('(display-mode: standalone)').matches) {
                installBanner.style.display = 'block';
            }
        }, 3000);
    });
</script>
    {% endif %}

    <style>
        .swal2-popup.swal2-rounded {
            border-radius: 15px !important;
        }

        .swal2-title-custom {
            color: #0a7735 !important;
            font-weight: 700;
        }

        .swal2-confirm-custom {
            border-radius: 8px !important;
            font-weight: 600 !important;
        }
    </style>

<div class="modal fade" id="modalAyuda" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Video de ayuda</h5>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body p-0">
        <iframe id="videoAyuda"
        width="100%"
        height="420"
        src=""
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen>
</iframe>

      </div>
    </div>
  </div>
</div>



<script>
$('.ayuda-btn').click(function () {
    let video = $(this).data('video');

    let url = `https://www.youtube.com/embed/${video}?rel=0&modestbranding=1&playsinline=1`;

    $('#videoAyuda').attr('src', url);
    $('#modalAyuda').modal('show');
});

$('#modalAyuda').on('hidden.bs.modal', function () {
    $('#videoAyuda').attr('src', '');
});
</script>



</body>

</html>